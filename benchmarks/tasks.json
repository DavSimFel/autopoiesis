[
  {
    "id": "basic_chat",
    "instruction": "What is 2+2? Reply with just the number.",
    "validate": "grep -q '4' $RESULT_FILE"
  },
  {
    "id": "file_write",
    "instruction": "Create a file called e2e_test.txt in your workspace containing the text 'hello autopoiesis'.",
    "validate": "find data/agent-workspace -name e2e_test.txt -exec grep -q 'hello autopoiesis' {} \\;",
    "teardown": "find data/agent-workspace -name e2e_test.txt -delete"
  },
  {
    "id": "file_read",
    "setup": "echo 'canary_value_42' > data/agent-workspace/e2e_readable.txt",
    "instruction": "Read the file e2e_readable.txt in your workspace and tell me what it contains.",
    "validate": "jq -r .result $OUTPUT_FILE | grep -qi 'canary_value_42'",
    "teardown": "rm -f data/agent-workspace/e2e_readable.txt"
  },
  {
    "id": "memory_roundtrip",
    "instruction": "First, memorize this using your memory tool: 'The secret code is ZEBRA-9876'. Then immediately search your memory and confirm you can find it. Include the code in your response.",
    "validate": "jq -r .result $OUTPUT_FILE | grep -qi 'ZEBRA-9876'"
  },
  {
    "id": "knowledge_search",
    "setup": "mkdir -p data/agent-workspace/knowledge/reference && echo '# Freedonia\nThe capital of Freedonia is Glorpville.' > data/agent-workspace/knowledge/reference/e2e_fact.md",
    "instruction": "Search your knowledge base for information about Freedonia.",
    "validate": "jq -r .result $OUTPUT_FILE | grep -qi 'Glorpville'",
    "teardown": "rm -f data/agent-workspace/knowledge/reference/e2e_fact.md"
  },
  {
    "id": "topic_list",
    "setup": "mkdir -p data/agent-workspace/topics && cp topics/*.md data/agent-workspace/topics/ 2>/dev/null || true",
    "instruction": "List all available topics.",
    "validate": "jq -r .result $OUTPUT_FILE | grep -qi 'research\\|code.review\\|writing'",
    "teardown": "rm -rf data/agent-workspace/topics"
  },
  {
    "id": "timeout_handling",
    "instruction": "Write a 10000-word essay about every planet in the solar system in extreme detail.",
    "timeout": 10,
    "expect_failure": true,
    "validate": "jq -r .success $OUTPUT_FILE | grep -q 'false'"
  }
]
